### Assembly Reversing WriteUp - 
# CTF Summary Exercise - Operation Lion 

Submitted by: Shirel Sananes 322328814
________________________________________________________________________________

### שלב 1: נטרול מערכת נ"מ

### **מטרה**

לנטרל סוללת נ"מ ולהגן על טייסים, תוך כדי הרצת הקובץ, הודפסו הודעות שמדגישות שישנם "פיתיונות" של האויב, וצריך לאתר את המטרה האמיתית במהירות.
הודעת שגיאה בסיום השלב הייתה: Danger! Anti aircraft system is still operating

### ניתוח הקוד:
#### 1. הבנת מבנה הפונקציה main: 
בתוך main, מתבצעים השלבים הבאים:

1. הדפסות ועיצוב טקסטואלי של הודעת השלב.
2. הפונקציה sub_401290 מדפיסה תווים באפקט איטי - שינוי שם הפונקציה בקוד שלי: Print_char_by_char
3. שליפת שני ערכים מהזיכרון הקבוע:
   
• משתנה ראשון: dword_405474 = 0x61646152 (מחרוזת 'R' 'a' 'd' 'a')
   
• משתנה שני: word_405478 = 0x72 (תו 'r')
   
← שילוב הערכים נותן את המחרוזת "Radar"

שני הערכים מאוחסנים בזיכרון המקומי (stack) ומועברים כמצביע לפונקציה sub_4013B0 (שינוי שם שלי בקוד: Xor2A_Double_NoEffect)

• ניתוח sub_4013B0:

הפונקציה מבצעת עיבוד על המחרוזת שהועברה לה:
1. מחושבת האורך של המחרוזת באמצעות לולאה שמחפשת את תו הסיום (\0)
2. לאחר מכן יש לולאה שמבצעת פעמיים XOR 0x2A על כל תו

המשמעות של הפעולה:

```c
for (i = 0; i < strlen(str); i++) {
    str[i] ^= 0x2A;
    str[i] ^= 0x2A;
}
```
מכיוון ש־XOR עם אותו ערך פעמיים מחזיר את הערך המקורי, הפונקציה לא משנה דבר בפועל. היא ככל הנראה נועדה לבלבל.

• ניתוח sub_401330:
  1. מאתחלת משתנה לערך '{' (0x7B)
  2. מריצה לולאה 5 פעמים:
```c
v = (i * 7) ^ v;
```
בסוף הלולאה, התוצאה היא v = 2
  
  3. קוראת לפונקציות הבאות:
     * קוראת ל־sub_4012E0(2) – ככל הנראה מחזירה מטרה ידועה (מחרוזת)
     * קוראת ל־sub_401430() – אולי איפוס מצב/טעינת קלט
     * קוראת ל־sub_401390(2, ptr) – השוואה בין המטרה שקיבלנו לבין הקלט בפועל


•	



o	sub_401290 (מדפיסה תווים באפקט איטי)
o	sub_4013B0 (מבצעת XOR כפול על מחרוזת)
o	sub_401330 (כנראה מבצעת פעולה לוגית)

והתוצאה השתנתה באופן מיידי:
```sql
Anti aircraft system located
Initiating disable sequence
Great job. Anti aircraft system is disabled
Stage 2: You are a jet fighter pilot. ...
```

סיכום שלב 1: 




