### Assembly Reversing WriteUp - 
# CTF Summary Exercise - Operation Lion 

Submitted by: Shirel Sananes 322328814
________________________________________________________________________________

### Stage 1: נטרול מערכת נ"מ

### **מטרה**

בשלב הראשון, הוגדרתי כמומחית ללוחמה מיוחדת, עם מטרה לנטרל סוללת נ"מ ולהגן על טייסים. תוך כדי הרצת הקובץ, התקבלו הודעות שמדגישות שישנם "פיתיונות" של האויב, וצריך לאתר את המטרה האמיתית במהירות.
הודעת שגיאה בסיום השלב הייתה: Danger! Anti aircraft system is still operating

### תחילת הניתוח – הבנת מבנה הפונקציה main: 
בסקירה ראשונית main מכילה הדפסות כותרות ומשתמש וקריאות למספר פרוצדורות:


•	הדפסת כותרות והודעות משתמש
•	קריאות למספר פרוצדרות פנימיות:
o	sub_401290 (מדפיסה תווים באפקט איטי)
o	sub_4013B0 (מבצעת XOR כפול על מחרוזת)
o	sub_401330 (כנראה מבצעת פעולה לוגית)
•	טעינת מבנה מכתובות בזיכרון: 
o	dword_405474 = 0x61646152 → "RadA"
o	word_405478 = 0x72 → 'r
המשכתי לנסות להבין מה כל פונקציה מבצעת: 
•	חקירת sub_4013B0:
o	לולאה שפועלת על מחרוזת
o	מפעילה XOR 0x2A פעמיים על כל תו
הבנתי שהתוצאה בפועל היא השארת התו כמו שהוא, ולכן ככל הנראה מדובר בהסחה. 
לאחר ניתוח יחסית מעמיק של הקוד בו אני נכנסת לכל פונקציה ומנסה להבין מה היא, התחלתי להבין שאני משקיעה זמן רב ב"לוגיקה" מסובכת, כשבפועל ייתכן שמדובר ב־מנגנון הסחה מכוון. (בשלב הזה חזרתי להרצה הראשונית וקראתי שוב מה הופיעה בטקסט הראשוני)
והנחתי שככל הנראה המטרה של הפונקציות שניסיתי להבין עד כה הם כדי לבלבל את מי שמבצע ניתוח סטטי או דינמי.
מעבר לגישה מעשית – פתרון אמיתי:
בלי יותר מידי מחשבה חשבתי עשיתי חיפוש מחרוזות (strings):
ביצעתי חיפוש על המילים:
"Stage 1" ועל "Danger"
זיהיתי שהמחרוזות מופיעות בצורה רגילה באזור rdata
ניסיתי לזהות מי מדפיס אותן וראיתי שהן לא תלויות ממש בלוגיקה אלא קשורות לפרמטרים שהועברו לתוכנית.
הרצתי את הקובץ כך:
OperationLion  You are a special operations
והתוצאה השתנתה באופן מיידי:
Anti aircraft system located
Initiating disable sequence
Great job. Anti aircraft system is disabled
Stage 2: You are a jet fighter pilot. ...

סיכום שלב 1: 
בשלב זה זיהיתי שהקוד מכיל הסחות דעת ומבלבל עם מנגנוני אנטידיבאג, ובעזרת חיפוש מחרוזות גיליתי את הקלט הנכון שאיפשר לעקוף את הלוגיקה ולעבור שלב.



